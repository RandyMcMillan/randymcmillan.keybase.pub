<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>C# .NET Core &#8212; R A N D Y M c M I L L A N</title>
    <link rel="stylesheet" href="../../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
<link href="../../_static/solarized-dark.css" rel="stylesheet">
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RandyM</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">C# .NET Core</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/BeeICON-128.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="c-net-core">
<h1>C# .NET Core<a class="headerlink" href="#c-net-core" title="Permalink to this headline">¶</a></h1>
<p>The .NET Core framework runs on Linux, Windows and Mac OS. We will use C#, the most popular .NET language, to make a Remote Procedure Call (RPC) to the Liquid daemon, which you will need to start using the config file settings <a class="reference internal" href="app-examples-index.html#config"><span class="std std-ref">outlined above</span></a>.</p>
<p>Our aim is simply to make a call to Liquid using RPC by executing some basic C# code.</p>
<p id="csharp-reqs"><strong>Installing the .NET Core SDK</strong></p>
<p>You can skip this step if you already have the .NET Core SDK installed. The installation instructions are based upon Linux and will vary depending on which OS you are using.</p>
<p>Before installing the .NET Core SDK, you’ll need to register the Microsoft key used to validate the required repository, register the product repository itself, and then install the required dependencies.</p>
<p>Open a command prompt and run the following two commands.</p>
<p>Note that the command you run after “wget” is dependant on the which distribution of Linux you are running. Please check the .NET SDK <a class="reference external" href="https://dotnet.microsoft.com/download/linux-package-manager/rhel/sdk-current">download page</a> to get the right one. There are only two lines below so note the text wrap. The first starts with “wget”, the second with “sudo”.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget -q packages-microsoft-prod.deb https://packages.microsoft.com/config/ubuntu/16.04/packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb
</pre></div>
</div>
<p>Now we can install the .NET Core SDK:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt-get install apt-transport-https
sudo apt-get update
sudo apt-get install dotnet-sdk-2.1.4
</pre></div>
</div>
<p><strong>Creating the application</strong></p>
<p>Create a simple template console app:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dotnet new console -o liquiddotnet
<span class="nb">cd</span> liquiddotnet
dotnet run
</pre></div>
</div>
<p>That will create a file in $HOME/liquiddotnet called Program.cs, execute the code within and output the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Hello World!
</pre></div>
</div>
<p>Edit the Program.cs file in $HOME/liquiddotnet using a text editor, change the contents to the following and then save the file: (note that some of the lines below wrap when viewed in a browser)</p>
<div class="highlight-C# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">liquiddotnet</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">static</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">MainAsync</span><span class="p">().</span><span class="n">GetAwaiter</span><span class="p">().</span><span class="n">GetResult</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">MainAsync</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="s">&quot;http://user1:password1@localhost:18884&quot;</span><span class="p">;</span>

            <span class="kt">var</span> <span class="n">contentData</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StringContent</span><span class="p">(</span><span class="s">@&quot;{&quot;&quot;method&quot;&quot;: &quot;&quot;getwalletinfo&quot;&quot;, &quot;&quot;jsonrpc&quot;&quot;: &quot;&quot;2.0&quot;&quot;}&quot;</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">&quot;application/json&quot;</span><span class="p">);</span>
            <span class="k">using</span> <span class="p">(</span><span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">PostAsync</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">contentData</span><span class="p">))</span>
            <span class="k">using</span> <span class="p">(</span><span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">data</span> <span class="p">=</span> <span class="k">await</span> <span class="n">content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span><span class="p">();</span>

                <span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="p">!=</span> <span class="n">data</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Running the application</strong></p>
<p>Before you try running any code, make sure the required daemon is running.</p>
<p>Move to the the directory with the file in, compile and run the application:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span>
<span class="nb">cd</span> liquiddotnet
dotnet run
</pre></div>
</div>
<p>Which outputs the results of the getwalletinfo command.</p>
<p>As an application would be making multiple calls to the Liquid daemon via RPC you will probably want to move the code that actually does the request and response work into its own function. An example of how to do this is the <a class="reference external" href="https://github.com/wintercooled/dotnetcoreDynamicJSON-RPC">dynamic JSON RPC class</a>, a C# wrapper class intended to enable simple dynamic JSON RPC calls to Bitcoin, Liquid, Elements and other RPC enabled daemons.</p>
<p>The code above is a starting point to get you up and running and you now have a functioning setup which you can use as a building block for further Liquid development.</p>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RandyM</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">C# .NET Core</a></li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2020, Randy McMillan.
      Last updated on Nov 06, 2020.
    </div>
  </body>
</html>